var slice$=[].slice;(function(){var viewer;(window.uploadr||(window.uploadr={})).viewer=viewer=function(opt){var lc,view,this$=this;this.root=typeof opt.root==="string"?ld$.find(opt.root,0):opt.root;if(!this.root){console.warn("[uploadr] warning: no node found for root ",opt.root)}this.evtHandler={};this.lc=lc={};this.images=lc.images=[];this.view=view=new ldView({root:this.root,action:{click:{list:function(arg$){var node,evt,n,src;node=arg$.node,evt=arg$.evt;if(!(n=ld$.parent(evt.target,"[data-src]",node))){return}src=n.getAttribute("data-src");return this$.fire("choose",{url:src})}}},handler:{item:{list:function(){return lc.images||[]},handle:function(arg$){var node,data,img,div;node=arg$.node,data=arg$.data;img=ld$.find(node,"img",0);div=ld$.find(node,"div",0);if(img.getAttribute("src")===data.url){return}node.setAttribute("data-src",data.url);node.style.display="none";img.onload=function(){return node.style.display="block"};img.setAttribute("src",data.url);return div.style.backgroundImage="url("+data.url+")"}}}});this.page=new ldPage(opt.page);this.page.init();this.page.on("fetch",function(it){lc.images=lc.images.concat(it);return view.render()});return this};return viewer.prototype=import$(Object.create(Object.prototype),{on:function(n,cb){var ref$;return((ref$=this.evtHandler)[n]||(ref$[n]=[])).push(cb)},fire:function(n){var v,i$,ref$,len$,cb,results$=[];v=slice$.call(arguments,1);for(i$=0,len$=(ref$=this.evtHandler[n]||[]).length;i$<len$;++i$){cb=ref$[i$];results$.push(cb.apply(this,v))}return results$}})})();function import$(obj,src){var own={}.hasOwnProperty;for(var key in src)if(own.call(src,key))obj[key]=src[key];return obj}
