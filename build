#!/usr/bin/env bash
rm -rf dist
mkdir -p dist
echo "build src/client.ls -> dist/uploadr.js ..."
npx lsc -cbp src/client.ls > dist/uploadr.js
echo "build src/server.ls -> dist/server.js ..."
npx lsc -cbp src/server.ls > dist/server.js
echo "build src/uploadr.styl -> dist/uploadr.css ..."
npx stylus -p src/uploadr.styl > dist/uploadr.css
echo "minifying uploadr.js ..."
npx uglifyjs dist/uploadr.js > dist/uploadr.min.js
echo "minifying uploadr.css ..."
npx uglifycss dist/uploadr.css > dist/uploadr.min.css
echo "copy pug file to dist/ ..."
cp src/uploadr.pug dist/uploadr.pug
echo "deploy into local web ..."
rm -rf web/static/assets/lib/uploadr/dev/
mkdir -p web/static/assets/lib/uploadr/dev/
cp -R dist/* web/static/assets/lib/uploadr/dev/
echo "done."
