(function(){uploadr.ext.gcs=function(e){var n,t,r,o;return n=e.files,t=e.progress,r=e.opt,o=e.data,new Promise(function(e,a){var i,u;return[],n.length,i=r.domain||"https://storage.googleapis.com",(u=new FormData).append("count",n.length),null!=o&&u.append("data","object"==typeof o?JSON.stringify(o):o),ld$.fetch(r.route,{method:"POST",body:u},{type:"json"}).then(function(e){return Promise.all(n.map(function(n,o){var a,u,c;return a=e[o],u=a.signedUrl,c=a.id,ld$.xhr(u,{method:"PUT",body:n.file,headers:{"Content-Type":n.file.type}},{noDefaultHeaders:!0,progress:function(e){return t({percent:e.percent,item:n})}}).then(function(){return{name:n.file.name,id:c,url:i+"/"+r.bucket+"/"+c}}).catch(function(e){return{name:n.file.name,err:e}})}))}).then(function(n){return e(n)}).catch(function(e){return a(e)})})}}).call(this);
